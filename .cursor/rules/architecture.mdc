# Pet Food App - ê°œë°œ ì›ì¹™ ë° ê°€ì´ë“œë¼ì¸

## ğŸ—ï¸ ì•„í‚¤í…ì²˜ ì›ì¹™

### 1. ë ˆì´ì–´ ë¶„ë¦¬ (Layered Architecture)

#### Backend
```
Presentation Layer (API) â†’ Business Logic Layer (Services) â†’ Data Access Layer (Models/Repositories)
```

#### Frontend
```
Presentation Layer (Screens/Widgets) â†’ Domain Layer (Controllers/Providers) â†’ Data Layer (Repositories/Models)
```

**ì›ì¹™:**
- ê° ë ˆì´ì–´ëŠ” ìì‹ ì˜ ìƒìœ„ ë ˆì´ì–´ë§Œ ì•Œê³  ìˆì–´ì•¼ í•¨
- í•˜ìœ„ ë ˆì´ì–´ëŠ” ìƒìœ„ ë ˆì´ì–´ë¥¼ ì•Œì§€ ëª»í•´ì•¼ í•¨
- ë ˆì´ì–´ ê°„ ì§ì ‘ ì°¸ì¡° ê¸ˆì§€ (ì˜ì¡´ì„± ì—­ì „ ì›ì¹™)

### 2. ë‹¨ì¼ ì±…ì„ ì›ì¹™ (Single Responsibility Principle)

**ê° í´ë˜ìŠ¤/í•¨ìˆ˜ëŠ” í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì ¸ì•¼ í•¨**

âœ… ì¢‹ì€ ì˜ˆ:
```python
# Backend
class PriceService:
    def calculate_average(self, offer_id: UUID) -> float:
        # ê°€ê²© í‰ê·  ê³„ì‚°ë§Œ ë‹´ë‹¹
        pass

class AlertService:
    def check_price_drop(self, tracking: Tracking) -> Optional[Alert]:
        # ì•Œë¦¼ ì²´í¬ë§Œ ë‹´ë‹¹
        pass
```

```dart
// Frontend
class HomeController extends StateNotifier<HomeState> {
  // í™ˆ í™”ë©´ ìƒíƒœ ê´€ë¦¬ë§Œ ë‹´ë‹¹
  Future<void> loadRecommendations() async { ... }
}

class PriceFormatter {
  // ê°€ê²© í¬ë§·íŒ…ë§Œ ë‹´ë‹¹
  static String format(int price) { ... }
}
```

âŒ ë‚˜ìœ ì˜ˆ:
```python
# ì—¬ëŸ¬ ì±…ì„ì„ ê°€ì§„ í´ë˜ìŠ¤
class ProductService:
    def get_product(self): ...
    def calculate_price(self): ...
    def send_notification(self): ...
    def save_to_cache(self): ...
```

### 3. í™”ë©´/ë¼ìš°í„°ì—ëŠ” ë„ë©”ì¸ ë¡œì§ ê¸ˆì§€

**í™”ë©´(Screen)ê³¼ ë¼ìš°í„°ëŠ” ì˜¤ì§ UI ë Œë”ë§ê³¼ ë„¤ë¹„ê²Œì´ì…˜ë§Œ ë‹´ë‹¹**

âœ… ì¢‹ì€ ì˜ˆ:
```dart
// í™”ë©´ì€ UIë§Œ ë‹´ë‹¹
class HomeScreen extends ConsumerWidget {
  @override
  Widget build(BuildContext context) {
    final state = ref.watch(homeControllerProvider);
    return ListView(
      children: state.items.map((item) => ProductCard(item: item)).toList(),
    );
  }
}

// ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ì»¨íŠ¸ë¡¤ëŸ¬ì—
class HomeController extends StateNotifier<HomeState> {
  Future<void> loadRecommendations() async {
    // ì‹¤ì œ ë¡œì§ì€ ì—¬ê¸°
  }
}
```

âŒ ë‚˜ìœ ì˜ˆ:
```dart
// í™”ë©´ì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ìˆìŒ
class HomeScreen extends ConsumerWidget {
  @override
  Widget build(BuildContext context) {
    // âŒ í™”ë©´ì—ì„œ ì§ì ‘ API í˜¸ì¶œ
    final response = await apiClient.get('/products/recommendations');
    
    // âŒ í™”ë©´ì—ì„œ ë°ì´í„° ë³€í™˜
    final items = response.data.map((json) {
      return ProductDto.fromJson(json);
    }).toList();
    
    // âŒ í™”ë©´ì—ì„œ ê°€ê²© ê³„ì‚°
    final avgPrice = items.fold(0, (sum, item) => sum + item.price) / items.length;
  }
}
```

### 4. ì˜ì¡´ì„± ì—­ì „ ì›ì¹™ (Dependency Inversion)

**ê³ ìˆ˜ì¤€ ëª¨ë“ˆì€ ì €ìˆ˜ì¤€ ëª¨ë“ˆì— ì˜ì¡´í•˜ì§€ ì•Šì•„ì•¼ í•¨**

âœ… ì¢‹ì€ ì˜ˆ:
```python
# ServiceëŠ” Repository ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´
class AlertService:
    def __init__(self, tracking_repo: TrackingRepository):
        self.tracking_repo = tracking_repo
```

```dart
// ControllerëŠ” Repositoryì— ì˜ì¡´ (êµ¬í˜„ì²´ê°€ ì•„ë‹Œ ì¶”ìƒí™”)
class HomeController extends StateNotifier<HomeState> {
  final ProductRepository _repository;
  HomeController(this._repository);
}
```

### 5. í•¨ìˆ˜ëŠ” ìˆœìˆ˜ í•¨ìˆ˜ë¡œ ì‘ì„±

**ë¶€ìˆ˜ íš¨ê³¼(side effect)ë¥¼ ìµœì†Œí™”í•˜ê³ , ì…ë ¥ì— ëŒ€í•´ ì˜ˆì¸¡ ê°€ëŠ¥í•œ ì¶œë ¥ì„ ë°˜í™˜**

âœ… ì¢‹ì€ ì˜ˆ:
```dart
// ìˆœìˆ˜ í•¨ìˆ˜
class PriceFormatter {
  static String format(int price) {
    return price.toString().replaceAllMapped(
      RegExp(r'(\d)(?=(\d{3})+(?!\d))'),
      (match) => '${match[1]},',
    );
  }
}
```

âŒ ë‚˜ìœ ì˜ˆ:
```dart
// ë¶€ìˆ˜ íš¨ê³¼ê°€ ìˆëŠ” í•¨ìˆ˜
String formatPrice(int price) {
  // âŒ ì „ì—­ ìƒíƒœ ë³€ê²½
  lastFormattedPrice = price;
  // âŒ ë¡œê¹… (ë¶€ìˆ˜ íš¨ê³¼)
  print('Formatting price: $price');
  return price.toString();
}
```

### 6. ë°ì´í„° íë¦„ì€ ë‹¨ë°©í–¥ìœ¼ë¡œ

**Frontend ìƒíƒœ ê´€ë¦¬: ë‹¨ë°©í–¥ ë°ì´í„° íë¦„**

```
User Action â†’ Controller â†’ Repository â†’ API â†’ Response â†’ Controller â†’ State â†’ UI Update
```

âœ… ì¢‹ì€ ì˜ˆ:
```dart
// ë‹¨ë°©í–¥ ë°ì´í„° íë¦„
class HomeController extends StateNotifier<HomeState> {
  Future<void> loadRecommendations() async {
    state = state.copyWith(isLoading: true);
    try {
      final data = await _repository.getRecommendations();
      state = state.copyWith(isLoading: false, recommendations: data);
    } catch (e) {
      state = state.copyWith(isLoading: false, error: e.toString());
    }
  }
}
```

### 7. ì—ëŸ¬ ì²˜ë¦¬ ì›ì¹™

**ì—ëŸ¬ëŠ” ì ì ˆí•œ ë ˆì´ì–´ì—ì„œ ì²˜ë¦¬í•˜ê³ , ì‚¬ìš©ìì—ê²Œ ì˜ë¯¸ ìˆëŠ” ë©”ì‹œì§€ ì œê³µ**

âœ… ì¢‹ì€ ì˜ˆ:
```python
# Backend: Service ë ˆì´ì–´ì—ì„œ ì—ëŸ¬ ì²˜ë¦¬
class AlertService:
    async def create_alert(self, data: AlertCreate) -> Alert:
        try:
            tracking = await self.tracking_repo.get(data.tracking_id)
            if not tracking:
                raise ValueError("Tracking not found")
            return await self.alert_repo.create(data)
        except ValueError as e:
            raise HTTPException(status_code=404, detail=str(e))
```

```dart
// Frontend: Repositoryì—ì„œ ì—ëŸ¬ë¥¼ Failureë¡œ ë³€í™˜
class ProductRepository {
  Future<RecommendationResponseDto> getRecommendations(String petId) async {
    try {
      final response = await _apiClient.get(...);
      return RecommendationResponseDto.fromJson(response.data);
    } on DioException catch (e) {
      throw NetworkException('ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    }
  }
}
```

### 8. ë„¤ì´ë° ì»¨ë²¤ì…˜

#### Backend (Python)
- **í´ë˜ìŠ¤**: PascalCase (`ProductService`, `AlertController`)
- **í•¨ìˆ˜/ë³€ìˆ˜**: snake_case (`get_product`, `user_id`)
- **ìƒìˆ˜**: UPPER_SNAKE_CASE (`MAX_RETRY_COUNT`)
- **Private**: ì•ì— ì–¸ë”ìŠ¤ì½”ì–´ (`_internal_method`)

#### Frontend (Dart)
- **í´ë˜ìŠ¤**: PascalCase (`HomeController`, `ProductDto`)
- **í•¨ìˆ˜/ë³€ìˆ˜**: camelCase (`loadRecommendations`, `userId`)
- **ìƒìˆ˜**: camelCase ë˜ëŠ” PascalCase (`PetConstants.breeds`)
- **Private**: ì•ì— ì–¸ë”ìŠ¤ì½”ì–´ (`_privateMethod`)

### 9. íŒŒì¼ êµ¬ì¡° ì›ì¹™

#### Backend
```
app/
â”œâ”€â”€ api/v1/          # API ì—”ë“œí¬ì¸íŠ¸ (ë¼ìš°í„°ë§Œ)
â”œâ”€â”€ services/        # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”œâ”€â”€ models/          # DB ëª¨ë¸ (ORM)
â”œâ”€â”€ schemas/         # Pydantic ìŠ¤í‚¤ë§ˆ (Request/Response)
â””â”€â”€ core/            # ê³µí†µ ì„¤ì •
```

**ì›ì¹™:**
- `api/`ì—ëŠ” ë¼ìš°í„° ì •ì˜ë§Œ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì—†ìŒ)
- `services/`ì— ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
- `models/`ëŠ” DB ìŠ¤í‚¤ë§ˆë§Œ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì—†ìŒ)

#### Frontend
```
features/
â””â”€â”€ feature_name/
    â””â”€â”€ presentation/
        â”œâ”€â”€ screens/      # í™”ë©´ (UIë§Œ)
        â”œâ”€â”€ widgets/      # ìœ„ì ¯ (UIë§Œ)
        â””â”€â”€ controllers/  # ìƒíƒœ ê´€ë¦¬ (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¡°ìœ¨)
```

**ì›ì¹™:**
- `screens/`ì—ëŠ” UI ë Œë”ë§ë§Œ
- `widgets/`ì—ëŠ” ì¬ì‚¬ìš© ê°€ëŠ¥í•œ UI ì»´í¬ë„ŒíŠ¸ë§Œ
- `controllers/`ì—ëŠ” ìƒíƒœ ê´€ë¦¬ì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì¡°ìœ¨

### 10. í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„±

**ì˜ì¡´ì„± ì£¼ì…ì„ í†µí•´ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ ì½”ë“œ ì‘ì„±**

âœ… ì¢‹ì€ ì˜ˆ:
```python
# ì˜ì¡´ì„± ì£¼ì…ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
class AlertService:
    def __init__(self, tracking_repo: TrackingRepository, alert_repo: AlertRepository):
        self.tracking_repo = tracking_repo
        self.alert_repo = alert_repo
```

```dart
// Mock ê°€ëŠ¥í•œ êµ¬ì¡°
class HomeController extends StateNotifier<HomeState> {
  final ProductRepository _repository;
  HomeController(this._repository); // ì˜ì¡´ì„± ì£¼ì…
}
```

### 11. ì½”ë“œ ì¤‘ë³µ ì œê±°

**DRY (Don't Repeat Yourself) ì›ì¹™ ì¤€ìˆ˜**

- ê³µí†µ ë¡œì§ì€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë¡œ ì¶”ì¶œ
- ë°˜ë³µë˜ëŠ” íŒ¨í„´ì€ ê³µí†µ ì»´í¬ë„ŒíŠ¸/ì„œë¹„ìŠ¤ë¡œ ë¶„ë¦¬
- ìƒìˆ˜ëŠ” ë³„ë„ íŒŒì¼ë¡œ ê´€ë¦¬

### 12. íƒ€ì… ì•ˆì •ì„±

**ëª…ì‹œì  íƒ€ì… ì‚¬ìš©ìœ¼ë¡œ ëŸ°íƒ€ì„ ì—ëŸ¬ ë°©ì§€**

âœ… ì¢‹ì€ ì˜ˆ:
```python
def create_pet(data: PetCreate, db: AsyncSession) -> PetRead:
    # ëª…ì‹œì  íƒ€ì… íŒíŠ¸
    pass
```

```dart
Future<RecommendationResponseDto> getRecommendations(String petId) async {
  // ëª…ì‹œì  ë°˜í™˜ íƒ€ì…
}
```

### 13. ì£¼ì„ ë° ë¬¸ì„œí™”

**ë³µì¡í•œ ë¡œì§ì—ëŠ” ì£¼ì„ ì¶”ê°€, Public APIëŠ” ë¬¸ì„œí™”**

```python
def calculate_14day_average(
    db: AsyncSession,
    offer_id: UUID
) -> Optional[float]:
    """
    ìµœê·¼ 14ì¼ ì´ë™ í‰ê·  ê³„ì‚°
    
    Args:
        db: ë°ì´í„°ë² ì´ìŠ¤ ì„¸ì…˜
        offer_id: ìƒí’ˆ ì œì•ˆ ID
        
    Returns:
        14ì¼ í‰ê·  ê°€ê²©, ë°ì´í„°ê°€ ì—†ìœ¼ë©´ None
    """
    pass
```

### 14. Git ì»¤ë°‹ ë©”ì‹œì§€ ì»¨ë²¤ì…˜

```
feat: ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€
fix: ë²„ê·¸ ìˆ˜ì •
refactor: ì½”ë“œ ë¦¬íŒ©í† ë§
docs: ë¬¸ì„œ ìˆ˜ì •
style: ì½”ë“œ í¬ë§·íŒ…
test: í…ŒìŠ¤íŠ¸ ì¶”ê°€/ìˆ˜ì •
chore: ë¹Œë“œ ì„¤ì • ë“±
```

## ğŸš« ê¸ˆì§€ ì‚¬í•­

1. âŒ í™”ë©´ì—ì„œ ì§ì ‘ API í˜¸ì¶œ (`Dio`, `ApiClient` ì§ì ‘ ì‚¬ìš©)
2. âŒ ë¼ìš°í„°ì—ì„œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
3. âŒ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ì§ì ‘ DB ì ‘ê·¼
4. âŒ ì „ì—­ ë³€ìˆ˜ ì‚¬ìš© (ìƒíƒœëŠ” Provider/StateNotifierë¡œ ê´€ë¦¬)
5. âŒ í•˜ë“œì½”ë”©ëœ ê°’ (ìƒìˆ˜ íŒŒì¼ë¡œ ë¶„ë¦¬)
6. âŒ ìˆœí™˜ ì°¸ì¡° (import cycle)
7. âŒ ë„ˆë¬´ ê¹Šì€ ì¤‘ì²© (3ë‹¨ê³„ ì´ìƒ ì§€ì–‘)
8. âŒ ë§¤ì§ ë„˜ë²„/ë¬¸ìì—´ (ìƒìˆ˜ë¡œ ì •ì˜)

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

ì½”ë“œ ì‘ì„± ì‹œ í™•ì¸:

- [ ] í™”ë©´ì— ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ì—†ë‚˜?
- [ ] ê° í•¨ìˆ˜ê°€ ë‹¨ì¼ ì±…ì„ì„ ê°€ì§€ë‚˜?
- [ ] ì˜ì¡´ì„±ì´ ì ì ˆí•œ ë°©í–¥ìœ¼ë¡œ íë¥´ë‚˜?
- [ ] ì—ëŸ¬ ì²˜ë¦¬ê°€ ì ì ˆí•œ ë ˆì´ì–´ì—ì„œ ì´ë£¨ì–´ì§€ë‚˜?
- [ ] íƒ€ì…ì´ ëª…ì‹œì ìœ¼ë¡œ ì •ì˜ë˜ì–´ ìˆë‚˜?
- [ ] í…ŒìŠ¤íŠ¸ ê°€ëŠ¥í•œ êµ¬ì¡°ì¸ê°€?
- [ ] ì½”ë“œ ì¤‘ë³µì´ ì—†ë‚˜?
- [ ] ë„¤ì´ë°ì´ ëª…í™•í•œê°€?

## ğŸ“š ì°¸ê³  ìë£Œ

- Clean Architecture (Robert C. Martin)
- SOLID ì›ì¹™
- Flutter Best Practices
- FastAPI Best Practices
